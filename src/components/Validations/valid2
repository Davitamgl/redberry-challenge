import {
  setIsValidUser,
  setValidationData,
  getValidationData,
} from "../../redux/userDataSlice";

import { useDispatch, useSelector } from "react-redux";

const ValidateUser = () => {
  console.log("hey")
  const validationData = useSelector(getValidationData);
  const dispatch = useDispatch();

  const errors = {
    firstNameError: "",
    lastNameError: "",
    emailError: "",
  }

  //////////////////////////FirstName/////////////////////

  if (validationData.firstName.length) {
    if (
      !/^[აბგდევზთიკლმნოპჟრსტუფქღყშჩცძწჭხჯჰ]+$/.test(validationData.firstName) &&
      !/^[a-zA-Z]+$/.test(validationData.firstName) &&
      validationData.firstName.length >= 1
    ) {
      errors.firstNameError =
        "სახელის ველი უნდა შეიცავდეს მხოლოდ ანბანის ასოებს";
    } else if (validationData.firstName.length >= 1 && validationData.firstName.length <= 2) {
      errors.firstNameError =
        "სახელის ველი უნდა შედგებოდეს მინიმუმ 3 სიმბოლოგან";
    } else if (validationData.firstName.length > 255) {
      errors.firstNameError =
        "სახელის ველი უნდა შედგებოდეს მაქსიმუმ 255 სიმბოლოსგან";
    } else {
      errors.firstNameError = "";
    }
  }

  //////////////////////////LastName/////////////////////

  if (validationData.lastName.length) {
    if (
      !/^[აბგდევზთიკლმნოპჟრსტუფქღყშჩცძწჭხჯჰ]+$/.test(validationData.lastName) &&
      !/^[a-zA-Z]+$/.test(validationData.lastName) &&
      validationData.lastName.length >= 1
    ) {
      errors.lastNameError = "გვარის ველი უნდა შეიცავდეს მხოლოდ ანბანის ასოებს";
    } else if (validationData.lastName.length >= 1 && validationData.lastName.length <= 2) {
      errors.lastNameError = "გვარის ველი უნდა შედგებოდეს მინიმუმ 3 სიმბოლოგან";
    } else if (validationData.lastName.length > 255) {
      errors.lastNameError =
        "გვარის ველი უნდა შედგებოდეს მაქსიმუმ 255 სიმბოლოსგან";
    } else {
      errors.lastNameError = "";
    }
  }

  //////////////////////////Email/////////////////////
  if (validationData.email.length) {
    if (
      !/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(
        validationData.email
      ) &&
      validationData.email.length >= 1
    ) {
      errors.emailError = "თქვენს მიერ შეყვანილი მეილი არასწორია";
    } else if (
      !validationData.email.endsWith("@redberry.ge") &&
      validationData.email.length >= 1
    ) {
      errors.emailError =
        "გთხოვთ დარეგისტრირდეთ რედბერის მეილით(youremail@redberry.ge)";
    } else {
      errors.email = "";
    }
  }

  dispatch(setValidationData(errors))
};

export default ValidateUser;
